# ConTech-DX

ê±´ì¶•ì§ì˜ê³µì‚¬ ê³µì •ê´€ë¦¬ ì‹œìŠ¤í…œ

## Tech Stack

| ì˜ì—­ | ê¸°ìˆ  |
|------|------|
| **Framework** | Next.js 16 (App Router) |
| **Language** | TypeScript (Strict Mode) |
| **Database** | Supabase (PostgreSQL) |
| **Styling** | Tailwind CSS 4 |
| **UI** | Radix UI, Framer Motion |
| **Form** | React Hook Form + Zod |
| **AI** | Google Gemini API (File Search) |
| **Testing** | Jest + React Testing Library |
| **Caching** | TTL-based Memory Cache |

## Getting Started

```bash
# ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# ê°œë°œ ì„œë²„ ì‹¤í–‰
npm run dev

# í”„ë¡œë•ì…˜ ë¹Œë“œ
npm run build

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
npm run test

# í…ŒìŠ¤íŠ¸ ì›Œì¹˜ ëª¨ë“œ
npm run test:watch

# í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€
npm run test:coverage
```

## Project Structure

```
src/
â”œâ”€â”€ __tests__/                    # í…ŒìŠ¤íŠ¸ íŒŒì¼
â”‚   â”œâ”€â”€ components/               # ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸
â”‚   â””â”€â”€ utils/                    # ìœ í‹¸ë¦¬í‹° í…ŒìŠ¤íŠ¸
â”‚
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ (container)/              # Route Group (ë©”ì¸ ì»¨í…ì¸ )
â”‚   â”‚   â”œâ”€â”€ admin/                # ê´€ë¦¬ì í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ login/                # ë¡œê·¸ì¸
â”‚   â”‚   â”œâ”€â”€ signup/               # íšŒì›ê°€ì…
â”‚   â”‚   â”œâ”€â”€ posts/                # ê²Œì‹œíŒ
â”‚   â”‚   â”œâ”€â”€ profile/              # í”„ë¡œí•„
â”‚   â”‚   â”œâ”€â”€ projects/             # í”„ë¡œì íŠ¸ ê´€ë¦¬
â”‚   â”‚   â””â”€â”€ layout.tsx
â”‚   â”œâ”€â”€ api/                      # API Routes
â”‚   â”‚   â”œâ”€â”€ gemini/               # Gemini AI API
â”‚   â”‚   â””â”€â”€ users/                # ì‚¬ìš©ì API
â”‚   â”œâ”€â”€ auth/callback/            # Supabase Auth Callback
â”‚   â””â”€â”€ file-search/              # AI íŒŒì¼ ê²€ìƒ‰
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/                       # ë””ìì¸ ì‹œìŠ¤í…œ (Button, Card, Dialog...)
â”‚   â”œâ”€â”€ auth/                     # ì¸ì¦ (LoginForm, SignupForm)
â”‚   â”œâ”€â”€ posts/                    # ê²Œì‹œê¸€
â”‚   â”œâ”€â”€ comments/                 # ëŒ“ê¸€
â”‚   â”œâ”€â”€ projects/                 # í”„ë¡œì íŠ¸ ê´€ë¦¬
â”‚   â”œâ”€â”€ buildings/                # ë™/ì¸µ ê´€ë¦¬
â”‚   â”œâ”€â”€ layout/                   # NavBar, ThemeToggle
â”‚   â”œâ”€â”€ file-search/              # AI íŒŒì¼ ê²€ìƒ‰
â”‚   â””â”€â”€ admin/                    # ê´€ë¦¬ì ì»´í¬ë„ŒíŠ¸
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ types.ts                  # íƒ€ì… ì •ì˜ (Single Source of Truth)
â”‚   â”œâ”€â”€ constants.ts              # ìƒìˆ˜ ì •ì˜
â”‚   â”œâ”€â”€ utils.ts                  # cn() ë“± ê¸°ë³¸ ìœ í‹¸
â”‚   â”œâ”€â”€ utils/                    # ìœ í‹¸ë¦¬í‹° ëª¨ë“ˆ
â”‚   â”‚   â”œâ”€â”€ formatters.ts         # ë‚ ì§œ, í†µí™” í¬ë§·íŒ…
â”‚   â”‚   â”œâ”€â”€ project-status.ts     # í”„ë¡œì íŠ¸ ìƒíƒœ ìƒ‰ìƒ/ë¼ë²¨
â”‚   â”‚   â”œâ”€â”€ logger.ts             # í™˜ê²½ë³„ ë¡œê¹…
â”‚   â”‚   â””â”€â”€ index.ts              # í†µí•© export
â”‚   â”œâ”€â”€ hooks/                    # ì»¤ìŠ¤í…€ í›…
â”‚   â”‚   â”œâ”€â”€ useAsyncData.ts       # ë¹„ë™ê¸° ë°ì´í„° í›…
â”‚   â”‚   â”œâ”€â”€ useTabDragDrop.ts     # íƒ­ ë“œë˜ê·¸ì•¤ë“œë¡­ í›…
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ supabase/                 # Supabase í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ client.ts             # í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ
â”‚   â”‚   â””â”€â”€ server.ts             # ì„œë²„ ì‚¬ì´ë“œ
â”‚   â”œâ”€â”€ services/                 # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ cache.ts              # TTL ê¸°ë°˜ ìºì‹±
â”‚   â”‚   â”œâ”€â”€ posts.ts
â”‚   â”‚   â”œâ”€â”€ comments.ts
â”‚   â”‚   â”œâ”€â”€ users.ts
â”‚   â”‚   â”œâ”€â”€ projects.ts           # í”„ë¡œì íŠ¸ CRUD
â”‚   â”‚   â”œâ”€â”€ projectMembers.ts     # í”„ë¡œì íŠ¸ ë©¤ë²„ ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ buildings.ts          # ë™/ì¸µ ê´€ë¦¬
â”‚   â”‚   â””â”€â”€ gemini.ts
â”‚   â””â”€â”€ permissions/              # ê¶Œí•œ ê´€ë¦¬
â”‚
â””â”€â”€ styles/
    â””â”€â”€ globals.css               # ê¸€ë¡œë²Œ ìŠ¤íƒ€ì¼ + í…Œë§ˆ
```

## Architecture

### ìºì‹± ì „ëµ
- **TTL ê¸°ë°˜ ë©”ëª¨ë¦¬ ìºì‹œ** (`src/lib/services/cache.ts`)
- ê¸°ë³¸ TTL: 5ë¶„, ì§§ì€ TTL: 1ë¶„, ê¸´ TTL: 15ë¶„
- `getOrFetch()`: ìºì‹œ í™•ì¸ â†’ ì—†ìœ¼ë©´ fetch â†’ ì €ì¥
- CRUD ì‘ì—… ì‹œ ìë™ ìºì‹œ ë¬´íš¨í™”

### í¼ ì²˜ë¦¬ íŒ¨í„´
- **React Hook Form + Zod** í†µì¼
- ì„œë²„ ì‚¬ì´ë“œ ìœ íš¨ì„± ê²€ì¦
- Toast ê¸°ë°˜ ì—ëŸ¬/ì„±ê³µ ë©”ì‹œì§€

### ì—ëŸ¬ ì²˜ë¦¬ íŒ¨í„´
- í‘œì¤€ API ì‘ë‹µ: `ApiResponse<T>` íƒ€ì…
- í´ë¼ì´ì–¸íŠ¸: `toast.success()` / `toast.error()`
- ì„œë²„: `logger` ìœ í‹¸ë¦¬í‹° ì‚¬ìš©

## Key Features

### í”„ë¡œì íŠ¸ ê´€ë¦¬
- í”„ë¡œì íŠ¸ CRUD (ìƒì„±, ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œ)
- ìƒíƒœ ê´€ë¦¬ (ê³µëª¨, ì…ì°°, ìˆ˜ì£¼, ì°©ê³µ, ì¤€ê³µ)
- í”„ë¡œì íŠ¸ ë©¤ë²„ ê´€ë¦¬ (PM, ì—”ì§€ë‹ˆì–´, ê°ë…ì, ì‘ì—…ì)

### ê±´ì¶• ì§ì˜ê³µì‚¬ ë°ì´í„° ê´€ë¦¬
- ë™(Building) ê¸°ë³¸ ì •ë³´ ì…ë ¥
- ì¸µ(Floor) ìë™ ìƒì„± ë° ê´€ë¦¬
- ê³µì¢…ë³„ ë¬¼ëŸ‰ ë°ì´í„° ì…ë ¥
- ê³µì • ê³„íš ìˆ˜ë¦½

### AI íŒŒì¼ ê²€ìƒ‰
- Gemini API ê¸°ë°˜ ë¬¸ì„œ ê²€ìƒ‰
- ìŠ¤í† ì–´ ìƒì„±/ì‚­ì œ
- íŒŒì¼ ì—…ë¡œë“œ ë° RAG ê²€ìƒ‰

## Import ê·œì¹™

```typescript
// ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
import { formatCurrency, formatDate, logger } from '@/lib/utils/index';
import { getStatusLabel, getStatusColors } from '@/lib/utils/index';

// ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ê¶Œí•œ ì²´í¬
import { getCurrentUserProfile, isSystemAdmin } from '@/lib/permissions/server';

// íƒ€ì… import
import type { Project, Profile, UserRole } from '@/lib/types';

// UI ì»´í¬ë„ŒíŠ¸
import { Button, Card, Dialog } from '@/components/ui';

// ì„œë¹„ìŠ¤ ë ˆì´ì–´
import { getProjects, createProject } from '@/lib/services/projects';

// ì»¤ìŠ¤í…€ í›…
import { useAsyncData, useTabDragDrop } from '@/lib/hooks';
```

## ì‚¬ìš©ì ì—­í• 

| Role | ë ˆë²¨ | ì„¤ëª… |
|------|------|------|
| `admin` | 4 | ì‹œìŠ¤í…œ ê´€ë¦¬ì |
| `main_user` | 3 | ì£¼ìš” ì‚¬ìš©ì |
| `vip_user` | 2 | VIP ì‚¬ìš©ì |
| `user` | 1 | ì¼ë°˜ ì‚¬ìš©ì |

## Environment Variables

```bash
# .env.local
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
GEMINI_API_KEY=your_gemini_api_key
```

## Database

Supabase PostgreSQL ê¸°ë°˜ ë°ì´í„°ë² ì´ìŠ¤

- SQL ìŠ¤í‚¤ë§ˆ: `sql/schema/`
- ë§ˆì´ê·¸ë ˆì´ì…˜: `sql/migrations/`
- ìƒ˜í”Œ ë°ì´í„°: `sql/seeds/`

**ìƒì„¸ ìŠ¤í‚¤ë§ˆ ë° ì—°ê²° ì„¤ì •ì€ [readmeDB.md](./readmeDB.md) ì°¸ì¡°**

## Documentation

í”„ë¡œì íŠ¸ ë¬¸ì„œ: `docs/` í´ë”
- í”„ë¡œì íŠ¸ ìƒíƒœ ë¬¸ì„œ
- ì„¤ì • ê°€ì´ë“œ
<<<<<<< HEAD


  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                         ì—­ê´€ê³„ ë¶ˆì¼ì¹˜ ë¬¸ì œ                                     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                                             â”‚
  â”‚   countWorkingDays(A, B) = N                                                â”‚
  â”‚                    â†“                                                        â”‚
  â”‚   addWorkingDays(A, N) â‰  B   â† ğŸ”´ ì—­ê´€ê³„ ì„±ë¦½ ì•ˆ í•¨!                           â”‚
  â”‚                                                                             â”‚
  â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
  â”‚                                                                             â”‚
  â”‚   ì˜ˆì‹œ:                                                                      â”‚
  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚   â”‚ countWorkingDays(ì›”, í™”) = 1                                        â”‚  â”‚
  â”‚   â”‚ addWorkingDays(ì›”, 1)    = ì›”   â† ê°™ì€ ë‚ !                         â”‚  â”‚
  â”‚   â”‚                                                                      â”‚  â”‚
  â”‚   â”‚ ê¸°ëŒ€: addWorkingDays(ì›”, 1) = í™”                                   â”‚  â”‚
  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                                             â”‚
  â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
  â”‚                                                                             â”‚
  â”‚   ê·¸ë£¹ ë“œë˜ê·¸ì—ì„œì˜ ì˜í–¥:                                                    â”‚
  â”‚                                                                             â”‚
  â”‚   1. ë“œë˜ê·¸ ì‹œì‘:                                                          â”‚
  â”‚      offset = countWorkingDays(ê¸°ì¤€Task, ì´Task) = 1                      â”‚
  â”‚                                                                             â”‚
  â”‚   2. ë“œë˜ê·¸ ì™„ë£Œ/ë¯¸ë¦¬ë³´ê¸°:                                                  â”‚
  â”‚      newDate = addWorkingDays(ê¸°ì¤€ìƒˆìœ„ì¹˜, offset=1)                       â”‚
  â”‚             = ê¸°ì¤€ìƒˆìœ„ì¹˜ ê·¸ëŒ€ë¡œ (1ì¼ ì•ìœ¼ë¡œ ê°€ì§€ ì•ŠìŒ)                      â”‚
  â”‚                                                                             â”‚
  â”‚   3. ê²°ê³¼:                                                                 â”‚
  â”‚      ê¸°ì¤€ Taskì™€ offset=1ì¸ Taskê°€ ê°™ì€ ìœ„ì¹˜ì— ë Œë”ë§ë¨!                   â”‚
  â”‚                                                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
=======
- ê¸°ìˆ  ë¶„ì„ ë³´ê³ ì„œ
>>>>>>> main
